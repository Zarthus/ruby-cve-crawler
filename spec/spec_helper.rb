require 'rspec'
require_relative File.join('..', 'lib', 'cve_crawler')
require_relative 'mocks/rss_mock'
require_relative 'mocks/cve_crawler_mock'
require_relative 'mocks/vulnerability_mock'

def filter_fill_history(filter, size)
  size.times do
    filter.filter(VulnerabilityMock.generate)
  end

  filter
end

def create_core_object
  # Ensure a clear history and a large history buffer to avoid tests failing when the limit is reached
  tmp_core = CoreMock.new
  tmp_core.parser.filters[0].history_size = 50 if tmp_core.parser.filters[0].history_size < 50

  tmp_core
end
