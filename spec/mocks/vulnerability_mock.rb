# Generate new CVE vulnerabilities on the fly
class VulnerabilityMock
  def self.generate
    mocker = VulnerabilityMock.new
    id = mocker.identifier

    CVE::Vulnerability.new({
      :identifier => id,
      :title => mocker.title(id),
      :link => mocker.link(id),
      :description => mocker.description,
      :date => mocker.date
    })
  end

  def identifier
    year = Time.now.year
    "CVE-#{rand(2000..year)}-#{rand(0..9999)}"
  end

  def title(id=nil)
    (id || identifier) + ' (' + ['Lorem Ipsum', 'Some vulnerability', 'Your favourite software',
                                 'Firefox', 'Chromium', 'Thunderbird'].sample.split('').shuffle.join + ')'
  end

  def link(id=nil)
    'http://web.nvd.nist.gov/view/vuln/detail?vulnId=' + (id || identifier)
  end

  def description
    ['Hakuna Matata', 'What a wonderful phrase', 'Ain\'t no passing phrase', 'It means no worries',
     'for the rest of your days', 'It\'s our problem-free philosophy', 'Yeah. That\'s our motto',
     'What\'s a motto?'].sample.split('').shuffle.join
  end

  def date
    Time.now
  end
end
