require_relative 'spec_helper'

describe CVE::Filter do
  it 'should filter repeated identifiers' do
    filter = CVE::Filter.new
    vulnerability = VulnerabilityMock.generate

    expect(filter.filter(vulnerability)).to equal(false)
    expect(filter.filter(vulnerability)).to equal(true)
  end

  it 'should not filter different identifiers' do
    filter = CVE::Filter.new

    3.times do
      expect(filter.filter(VulnerabilityMock.generate)).to equal(false)
    end
  end
end
